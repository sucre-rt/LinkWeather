<div class="main">
  <% if @area.blank? %>
  <% else %>
    <% if @result["cod"] == "404" || @result == "" %>
      <div class="city-weather">
        <h1>該当する地域がありません。</h1>
      </div>
    <% else%>
      <%= render partial: './sub_areas/area_list', locals: { sub_areas: @sub_areas, my_area: @area } %>
      <div class="city-weather">
        <h2 class="forecast-title"><%= "#{@area}の天気" %></h2>
        <div class="now-weather-information">
          <div class="main-left">
            <h3>不快指数</h3>
            <p class="discomfort"></p>
            <p class="description"></p>
          </div>
          <div class="main-center">
            <p class="now-date"></p>
            <p class="on-time"></p>
            <%= image_tag "", class: "now-icon" %>
            <p class="now-weather"></p>
          </div>
          <div class="main-right">
            <p class="now-temp-max"></p>
            <p class="now-temp-min"></p>
            <p class="now-humidity"></p>
            <p class="now-wind"></p>
          </div>
          <% if user_signed_in? && current_user.my_area != @area %>
          <div class="sub-area-btn" id="sub-area-link-<%= @area %>">
            <%= render partial: 'sub_areas/sub_area_btn', locals: { city: @area } %>
          </div>
          <% end %>
        </div>

        <h2><%= "　#{@area}の３日間の予報" %></h2>
        <div class="weather-box">
          <%= render partial: 'weather', locals: { day_time: Time.local(@today.year, @today.month, @today.day, 0, 00, 00), time: "0:00:00", day: @today }%>
          <%= render partial: 'weather', locals: { day_time: Time.local(@today.year, @today.month, @today.day, 3, 00, 00), time: "3:00:00", day: @today }%>
          <%= render partial: 'weather', locals: { day_time: Time.local(@today.year, @today.month, @today.day, 6, 00, 00), time: "6:00:00", day: @today }%>
          <%= render partial: 'weather', locals: { day_time: Time.local(@today.year, @today.month, @today.day, 9, 00, 00), time: "9:00:00", day: @today }%>
          <%= render partial: 'weather', locals: { day_time: Time.local(@today.year, @today.month, @today.day, 12, 00, 00), time: "12:00:00", day: @today }%>
          <%= render partial: 'weather', locals: { day_time: Time.local(@today.year, @today.month, @today.day, 15, 00, 00), time: "15:00:00", day: @today }%>
          <%= render partial: 'weather', locals: { day_time: Time.local(@today.year, @today.month, @today.day, 18, 00, 00), time: "18:00:00", day: @today }%>
          <%= render partial: 'weather', locals: { day_time: Time.local(@today.year, @today.month, @today.day, 21, 00, 00), time: "21:00:00", day: @today }%>

          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 1.day).year, (@today + 1.day).month, (@today + 1.day).day, 0, 00, 00), time: "0:00:00", day: @today + 1.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 1.day).year, (@today + 1.day).month, (@today + 1.day).day, 3, 00, 00), time: "3:00:00", day: @today + 1.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 1.day).year, (@today + 1.day).month, (@today + 1.day).day, 6, 00, 00), time: "6:00:00", day: @today + 1.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 1.day).year, (@today + 1.day).month, (@today + 1.day).day, 9, 00, 00), time: "9:00:00", day: @today + 1.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 1.day).year, (@today + 1.day).month, (@today + 1.day).day, 12, 00, 00), time: "12:00:00", day: @today + 1.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 1.day).year, (@today + 1.day).month, (@today + 1.day).day, 15, 00, 00), time: "15:00:00", day: @today + 1.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 1.day).year, (@today + 1.day).month, (@today + 1.day).day, 18, 00, 00), time: "18:00:00", day: @today + 1.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 1.day).year, (@today + 1.day).month, (@today + 1.day).day, 21, 00, 00), time: "21:00:00", day: @today + 1.day }%>

          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 2.day).year, (@today + 1.day).month, (@today + 2.day).day, 0, 00, 00), time: "0:00:00", day: @today + 2.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 2.day).year, (@today + 1.day).month, (@today + 2.day).day, 3, 00, 00), time: "3:00:00", day: @today + 2.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 2.day).year, (@today + 1.day).month, (@today + 2.day).day, 6, 00, 00), time: "6:00:00", day: @today + 2.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 2.day).year, (@today + 1.day).month, (@today + 2.day).day, 9, 00, 00), time: "9:00:00", day: @today + 2.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 2.day).year, (@today + 1.day).month, (@today + 2.day).day, 12, 00, 00), time: "12:00:00", day: @today + 2.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 2.day).year, (@today + 1.day).month, (@today + 2.day).day, 15, 00, 00), time: "15:00:00", day: @today + 2.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 2.day).year, (@today + 1.day).month, (@today + 2.day).day, 18, 00, 00), time: "18:00:00", day: @today + 2.day }%>
          <%= render partial: 'weather', locals: { day_time: Time.local((@today + 2.day).year, (@today + 1.day).month, (@today + 2.day).day, 21, 00, 00), time: "21:00:00", day: @today + 2.day }%>
        </div>
      </div>
    <% end %>

    <%= render partial: './tweets/search', locals: { area: @area } %>

    <div class="right-under">
      <h2><%= @area %>のtwitter検索結果</h2>
      <div class="twitter">
        <% @twitter_tweets.take(15).each do |tweet| %>
          <blockquote class="twitter-tweet tw-align-center" data-lang="ja" data-width=”100%”>
            <%= link_to '',"https://twitter.com/#{ tweet[:user][:screen_name] }/status/#{ tweet[:id] }", target: :_blank %>     
          </blockquote>
        <% end %>
      </div>
    </div>
    
    <div id="popup-background">
    </div>
    <img id="popup-item" src="" >
    <% end %>
</div>
